config = {
    "cases": [
        {
            "datacard": "combine_SvB_MA",
            "signallabel": "ZZ_bbbb",
            "othersignal": "ZH_bbbb",
            "workspace": "output/tmp/"
        },
        {
            "datacard": "combine_SvB_MA",
            "signallabel": "ZH_bbbb",
            "othersignal": "ZZ_bbbb",
            "workspace": "output/tmp/"
        }
    ]
}

include: "../workflows/rules/combine.smk"

def make_outputs(patterns, cases):
    outputs = []
    for pat in patterns:
        outputs += expand(
            pat,
            workspace=[case["workspace"] for case in cases],
            datacard=[case["datacard"] for case in cases],
            signallabel=[case["signallabel"] for case in cases]
        )
    return outputs

output_patterns = [
    "{workspace}limits_{datacard}__{signallabel}.txt",
    "{workspace}significance_expected_{datacard}__{signallabel}.txt",
    "{workspace}impacts_combine_{datacard}__{signallabel}_observed.pdf",
    "{workspace}gof_{datacard}__{signallabel}.pdf",
    "{workspace}likelihood_scan_{datacard}__{signallabel}.pdf"
]

rule all:
    input:
        make_outputs(output_patterns, config["cases"])